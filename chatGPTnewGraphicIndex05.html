<!DOCTYPE html>
<html>
<head>
	<title>Tinkerbell Map</title>
	<style>
		canvas {
			border: 1px solid black;
		}
	</style>
</head>
<body>
	<canvas id="canvas"></canvas>
	<button onclick="toggleAnimation()">Toggle Animation</button>

	<script>
		const canvas = document.getElementById("canvas");
		const ctx = canvas.getContext("2d");

		const width = canvas.width;
		const height = canvas.height;

		const a = 0.9;
		const b = -0.6013;
		const c = 2.0;
		const d = 0.5;

		let x = 0.1;
		let y = 0.1;

		let isAnimating = true;

		function update() {
			if (isAnimating) {
				for (let i = 0; i < 100; i++) {
					const xNew = x * x - y * y + a * x + b * y;
					const yNew = 2 * x * y + c * x + d * y;
					x = xNew;
					y = yNew;
				}
			}
		}

		function draw() {
			ctx.clearRect(0, 0, width, height);

			ctx.fillStyle = "orange";
			ctx.fillRect(0, 0, width, height);

			ctx.strokeStyle = "white";
			ctx.beginPath();
			ctx.moveTo(width / 2 + x * 80, height / 2 + y * 80);
			for (let i = 0; i < 10000; i++) {
				const xNew = x * x - y * y + a * x + b * y;
				const yNew = 2 * x * y + c * x + d * y;
				x = xNew;
				y = yNew;

				if (i % 50 === 0) {
					const size = Math.max(0.1, 2 - i / 500);
					ctx.lineWidth = size;
					ctx.lineTo(width / 2 + x * 80, height / 2 + y * 80);
					ctx.stroke();
				}
			}

			requestAnimationFrame(draw);
		}

		function toggleAnimation() {
			isAnimating = !isAnimating;
		}

		setInterval(update, 16);
		requestAnimationFrame(draw);
	</script>
</body>
</html>
